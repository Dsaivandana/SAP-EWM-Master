<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZSCWM_RF_PICK_PIPLHU_PAI======FT</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZSCWM_RF_PICK_PIPLHU_PAI======FT</b></font>
<hr>
<pre width="100">
REPORT ZSCWM_RF_PICK_PIPLHU_PAI======FT.
<font color ="#0000FF">* 2.0</font>
<font color ="#0000FF">*</font>
DATA: TIME1 TYPE P, TIME2 TYPE P, RUNTIME(30), DEBUG, ATRA.
DATA: RC LIKE SY-SUBRC , V_RC LIKE SY-SUBRC.
DATA: DESTI LIKE RFCDES-RFCDEST.
DATA: FIELDNAME LIKE SY-REPID.
DATA: G_UPPER TYPE C.         "Gross/Kleinschreibung
<font color ="#0000FF">*</font>
TABLES : EUFUNC.
DATA: BEGIN OF UNTERSCHIED,            " Unterschiede bei Testdur
        PARAMETER(30),
        ALT(200),
        NEU(200),                      " laufen
      END OF UNTERSCHIED.
<font color ="#0000FF">*</font>
DATA : D102N_EXPORTKEY LIKE FUNCTDIR.
<font color ="#0000FF">*</font>
DATA : BEGIN OF EXPORTKEY,
         DATAID LIKE EUFUNC-NUMMER,
         SEQID  LIKE EUFUNC-SEQID,
       END OF EXPORTKEY.
DATA : BEGIN OF EXCEPTIONS OCCURS 10,
         NAME(30),
       END OF EXCEPTIONS.
DATA : VEXCEPTION(30).
DATA : OEXCEPTION(30).
DATA : NR2(250) TYPE C.
DATA : TABLEN TYPE I.
DATA : EX TYPE REF TO CX_ROOT.
DATA : DESCR_REF TYPE REF TO CL_ABAP_TYPEDESCR.
DATA : RESULTAT(30) TYPE C.
DATA : REST(30)     TYPE C.
<font color ="#0000FF">*</font>
DATA: %_ISELECTION TYPE /SCWM/S_RF_SELECTION.
DATA: %_OSELECTION TYPE /SCWM/S_RF_SELECTION.
DATA: %_VSELECTION TYPE /SCWM/S_RF_SELECTION.
DATA: %_IRESOURCE TYPE /SCWM/S_RSRC.
DATA: %_ORESOURCE TYPE /SCWM/S_RSRC.
DATA: %_VRESOURCE TYPE /SCWM/S_RSRC.
DATA: %_IWHO TYPE /SCWM/S_WHO_INT.
DATA: %_OWHO TYPE /SCWM/S_WHO_INT.
DATA: %_VWHO TYPE /SCWM/S_WHO_INT.
DATA: %_IORDIM_CONFIRM TYPE /SCWM/S_RF_ORDIM_CONFIRM.
DATA: %_OORDIM_CONFIRM TYPE /SCWM/S_RF_ORDIM_CONFIRM.
DATA: %_VORDIM_CONFIRM TYPE /SCWM/S_RF_ORDIM_CONFIRM.
DATA: %_INESTED_HU TYPE /SCWM/S_RF_NESTED_HU.
DATA: %_ONESTED_HU TYPE /SCWM/S_RF_NESTED_HU.
DATA: %_VNESTED_HU TYPE /SCWM/S_RF_NESTED_HU.
DATA: %_ITT_ORDIM_CONFIRM TYPE /SCWM/TT_RF_ORDIM_CONFIRM.
DATA: %_OTT_ORDIM_CONFIRM TYPE /SCWM/TT_RF_ORDIM_CONFIRM.
DATA: %_VTT_ORDIM_CONFIRM TYPE /SCWM/TT_RF_ORDIM_CONFIRM.
DATA: %_ITT_NESTED_HU TYPE /SCWM/TT_RF_NESTED_HU.
DATA: %_OTT_NESTED_HU TYPE /SCWM/TT_RF_NESTED_HU.
DATA: %_VTT_NESTED_HU TYPE /SCWM/TT_RF_NESTED_HU.
DATA: %_IT_RF_PICK_HUS TYPE /SCWM/TT_RF_PICK_HUS.
DATA: %_OT_RF_PICK_HUS TYPE /SCWM/TT_RF_PICK_HUS.
DATA: %_VT_RF_PICK_HUS TYPE /SCWM/TT_RF_PICK_HUS.
DATA: %_IWME_VERIF TYPE /SCWM/S_WME_VERIF.
DATA: %_OWME_VERIF TYPE /SCWM/S_WME_VERIF.
DATA: %_VWME_VERIF TYPE /SCWM/S_WME_VERIF.
FORM EXISTENCE_CHECK CHANGING VARIA.
  VARIA = 1.
ENDFORM.
FORM FUNCTION_CALL.
  CLEAR %_OSELECTION.
%_OSELECTION = %_ISELECTION.
  CLEAR %_ORESOURCE.
%_ORESOURCE = %_IRESOURCE.
  CLEAR %_OWHO.
%_OWHO = %_IWHO.
  CLEAR %_OORDIM_CONFIRM.
%_OORDIM_CONFIRM = %_IORDIM_CONFIRM.
  CLEAR %_ONESTED_HU.
%_ONESTED_HU = %_INESTED_HU.
  CLEAR %_OTT_ORDIM_CONFIRM.
%_OTT_ORDIM_CONFIRM = %_ITT_ORDIM_CONFIRM.
  CLEAR %_OTT_NESTED_HU.
%_OTT_NESTED_HU = %_ITT_NESTED_HU.
  CLEAR %_OT_RF_PICK_HUS.
%_OT_RF_PICK_HUS = %_IT_RF_PICK_HUS.
  CLEAR %_OWME_VERIF.
%_OWME_VERIF = %_IWME_VERIF.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI IS INITIAL.
IF DEBUG = '1'. BREAK-POINT AT NEXT APPLICATION STATEMENT.
ENDIF.
DEBUG = SPACE.
GET RUN TIME FIELD TIME1.
CALL FUNCTION 'ZSCWM_RF_PICK_PIPLHU_PAI'
CHANGING
SELECTION = %_OSELECTION
RESOURCE = %_ORESOURCE
WHO = %_OWHO
ORDIM_CONFIRM = %_OORDIM_CONFIRM
NESTED_HU = %_ONESTED_HU
TT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM
TT_NESTED_HU = %_OTT_NESTED_HU
T_RF_PICK_HUS = %_OT_RF_PICK_HUS
WME_VERIF = %_OWME_VERIF.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
ELSE.
GET RUN TIME FIELD TIME1.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI = 'SPACE'.
  DESTI = ' '.
ENDIF.
CALL FUNCTION 'ZSCWM_RF_PICK_PIPLHU_PAI' DESTINATION DESTI
CHANGING
SELECTION = %_OSELECTION
RESOURCE = %_ORESOURCE
WHO = %_OWHO
ORDIM_CONFIRM = %_OORDIM_CONFIRM
NESTED_HU = %_ONESTED_HU
TT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM
TT_NESTED_HU = %_OTT_NESTED_HU
T_RF_PICK_HUS = %_OT_RF_PICK_HUS
WME_VERIF = %_OWME_VERIF.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
  ENDIF.
  GET RUN TIME FIELD TIME2.
  RC = SY-SUBRC.
  CLEAR EXCEPTIONS.
  READ TABLE EXCEPTIONS INDEX RC.
  IF SY-SUBRC = 0.
  OEXCEPTION = EXCEPTIONS-NAME.
  ELSE.
  OEXCEPTION = RESULTAT.
  ENDIF.
  TIME1 = TIME2 - TIME1.
  WRITE TIME1 TO RUNTIME.
  CONDENSE RUNTIME.
ENDFORM.

FORM CLEAR_DATA.
  CLEAR %_ISELECTION.
  CLEAR %_OSELECTION.
  CLEAR %_VSELECTION.
  CLEAR %_IRESOURCE.
  CLEAR %_ORESOURCE.
  CLEAR %_VRESOURCE.
  CLEAR %_IWHO.
  CLEAR %_OWHO.
  CLEAR %_VWHO.
  CLEAR %_IORDIM_CONFIRM.
  CLEAR %_OORDIM_CONFIRM.
  CLEAR %_VORDIM_CONFIRM.
  CLEAR %_INESTED_HU.
  CLEAR %_ONESTED_HU.
  CLEAR %_VNESTED_HU.
  CLEAR %_ITT_ORDIM_CONFIRM.
  CLEAR %_OTT_ORDIM_CONFIRM.
  CLEAR %_VTT_ORDIM_CONFIRM.
  CLEAR %_ITT_NESTED_HU.
  CLEAR %_OTT_NESTED_HU.
  CLEAR %_VTT_NESTED_HU.
  CLEAR %_IT_RF_PICK_HUS.
  CLEAR %_OT_RF_PICK_HUS.
  CLEAR %_VT_RF_PICK_HUS.
  CLEAR %_IWME_VERIF.
  CLEAR %_OWME_VERIF.
  CLEAR %_VWME_VERIF.
ENDFORM.
FORM CLEAR_TABLE.
ENDFORM.
FORM DELETE_LINE USING KEY INDEX.
CASE KEY.
ENDCASE.
ENDFORM.
FORM INIT_EXCEPTIONS USING NAME.
  CLEAR EXCEPTIONS.
  MOVE NAME TO EXCEPTIONS-NAME.
  APPEND EXCEPTIONS.
ENDFORM.
FORM PARAM_ACCESS_TYPES USING KEY DEST P_MODE P_UPPER.
DATA : INTKEY(31).
  P_UPPER = G_UPPER.
  INTKEY = DEST.
  INTKEY+1 = KEY.
  CONDENSE INTKEY.
  CASE INTKEY.
    WHEN 'ISELECTION'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SELECTION'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ISELECTION.
    WHEN 'OSELECTION'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SELECTION'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OSELECTION.
    WHEN 'VSELECTION'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SELECTION'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VSELECTION.
    WHEN 'IRESOURCE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'RESOURCE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IRESOURCE.
    WHEN 'ORESOURCE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'RESOURCE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ORESOURCE.
    WHEN 'VRESOURCE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'RESOURCE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VRESOURCE.
    WHEN 'IWHO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WHO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IWHO.
    WHEN 'OWHO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WHO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OWHO.
    WHEN 'VWHO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WHO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VWHO.
    WHEN 'IORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IORDIM_CONFIRM.
    WHEN 'OORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OORDIM_CONFIRM.
    WHEN 'VORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VORDIM_CONFIRM.
    WHEN 'INESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_INESTED_HU.
    WHEN 'ONESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ONESTED_HU.
    WHEN 'VNESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VNESTED_HU.
    WHEN 'ITT_ORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ITT_ORDIM_CONFIRM.
    WHEN 'OTT_ORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OTT_ORDIM_CONFIRM.
    WHEN 'VTT_ORDIM_CONFIRM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_ORDIM_CONFIRM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VTT_ORDIM_CONFIRM.
    WHEN 'ITT_NESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ITT_NESTED_HU.
    WHEN 'OTT_NESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OTT_NESTED_HU.
    WHEN 'VTT_NESTED_HU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'TT_NESTED_HU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VTT_NESTED_HU.
    WHEN 'IT_RF_PICK_HUS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'T_RF_PICK_HUS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IT_RF_PICK_HUS.
    WHEN 'OT_RF_PICK_HUS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'T_RF_PICK_HUS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OT_RF_PICK_HUS.
    WHEN 'VT_RF_PICK_HUS'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'T_RF_PICK_HUS'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VT_RF_PICK_HUS.
    WHEN 'IWME_VERIF'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WME_VERIF'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IWME_VERIF.
    WHEN 'OWME_VERIF'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WME_VERIF'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OWME_VERIF.
    WHEN 'VWME_VERIF'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'WME_VERIF'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VWME_VERIF.
  ENDCASE.
ENDFORM.
FORM PARAMETER_SET USING NAME DIRECTION VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'ISELECTION'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ISELECTION.
WHEN 'IRESOURCE'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IRESOURCE.
WHEN 'IWHO'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IWHO.
WHEN 'IORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IORDIM_CONFIRM.
WHEN 'INESTED_HU'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_INESTED_HU.
WHEN 'ITT_ORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ITT_ORDIM_CONFIRM.
WHEN 'ITT_NESTED_HU'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ITT_NESTED_HU.
WHEN 'IT_RF_PICK_HUS'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IT_RF_PICK_HUS.
WHEN 'IWME_VERIF'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IWME_VERIF.
ENDCASE.
ENDFORM.
FORM PARAMETER_GET USING NAME DIRECTION
                   CHANGING   VALUE
                            OLD_VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'OSELECTION'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OSELECTION
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ISELECTION
   CHANGING OLD_VALUE.
WHEN 'ORESOURCE'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ORESOURCE
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IRESOURCE
   CHANGING OLD_VALUE.
WHEN 'OWHO'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OWHO
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IWHO
   CHANGING OLD_VALUE.
WHEN 'OORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OORDIM_CONFIRM
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IORDIM_CONFIRM
   CHANGING OLD_VALUE.
WHEN 'ONESTED_HU'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ONESTED_HU
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_INESTED_HU
   CHANGING OLD_VALUE.
WHEN 'OTT_ORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OTT_ORDIM_CONFIRM
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ITT_ORDIM_CONFIRM
   CHANGING OLD_VALUE.
WHEN 'OTT_NESTED_HU'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OTT_NESTED_HU
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ITT_NESTED_HU
   CHANGING OLD_VALUE.
WHEN 'OT_RF_PICK_HUS'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OT_RF_PICK_HUS
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IT_RF_PICK_HUS
   CHANGING OLD_VALUE.
WHEN 'OWME_VERIF'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OWME_VERIF
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IWME_VERIF
   CHANGING OLD_VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_SET USING NAME VALUE.
CASE NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_GET USING NAME
                   CHANGING   VALUE.
CASE NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_DESCRIBE USING CBPROG
                              NAME.
CASE NAME.
WHEN 'SELECTION'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ISELECTION
         NAME.
WHEN 'RESOURCE'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IRESOURCE
         NAME.
WHEN 'WHO'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IWHO
         NAME.
WHEN 'ORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IORDIM_CONFIRM
         NAME.
WHEN 'NESTED_HU'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_INESTED_HU
         NAME.
WHEN 'TT_ORDIM_CONFIRM'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ITT_ORDIM_CONFIRM
         NAME.
WHEN 'TT_NESTED_HU'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ITT_NESTED_HU
         NAME.
WHEN 'T_RF_PICK_HUS'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IT_RF_PICK_HUS
         NAME.
WHEN 'WME_VERIF'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IWME_VERIF
         NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_CONTAINER TABLES LCONT STRUCTURE SWCONT
                         USING NAME
                               DIRECTION .
CASE NAME.
WHEN 'ISELECTION'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ISELECTION
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ISELECTION
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IRESOURCE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IRESOURCE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IRESOURCE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IWHO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IWHO
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IWHO
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IORDIM_CONFIRM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'INESTED_HU'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_INESTED_HU
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_INESTED_HU
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ITT_ORDIM_CONFIRM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ITT_ORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ITT_ORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ITT_NESTED_HU'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ITT_NESTED_HU
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ITT_NESTED_HU
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IT_RF_PICK_HUS'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IT_RF_PICK_HUS
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IT_RF_PICK_HUS
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IWME_VERIF'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IWME_VERIF
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IWME_VERIF
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OSELECTION'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OSELECTION
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OSELECTION
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ORESOURCE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ORESOURCE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ORESOURCE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OWHO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OWHO
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OWHO
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OORDIM_CONFIRM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ONESTED_HU'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ONESTED_HU
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ONESTED_HU
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OTT_ORDIM_CONFIRM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OTT_ORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OTT_ORDIM_CONFIRM
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OTT_NESTED_HU'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OTT_NESTED_HU
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OTT_NESTED_HU
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OT_RF_PICK_HUS'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OT_RF_PICK_HUS
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OT_RF_PICK_HUS
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OWME_VERIF'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OWME_VERIF
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OWME_VERIF
TABLES
CONTAINER = LCONT.
ENDIF.
ENDCASE.
ENDFORM.
FORM TABLES_CONTAINER TABLES LCONT STRUCTURE SWCONT
                      USING NAME
                            DIRECTION.
CASE NAME.
ENDCASE.
ENDFORM.
FORM SET_VARIABLES USING KEY VALUE.
  CASE KEY.
    WHEN '%%DEBUGON'.
      DEBUG = 1.
    WHEN '%%DEBUGOFF'.
      DEBUG = 0.
    WHEN '%%DESTI'.
      DESTI = VALUE.
    WHEN '%%ATRAON'.
      ATRA = 1.
    WHEN '%%ATRAOFF'.
      ATRA = 0.
    WHEN '%%UPPER'.
      G_UPPER = VALUE.
  ENDCASE.
ENDFORM.
FORM GET_VARIABLES USING    KEY
                   CHANGING VALUE.
  CASE KEY.
    WHEN '%%DEBUG'.
      VALUE = DEBUG.
    WHEN '%%DESTI'.
      VALUE = DESTI.
    WHEN '%%ATRA'.
      VALUE = ATRA.
    WHEN '%%SUBRC'.
      VALUE = RC.
    WHEN 'V%%SUBRC'.
      VALUE = V_RC.
    WHEN '%%TIME'.
      VALUE = RUNTIME.
    WHEN '%%UPPER'.
      VALUE = G_UPPER.
    WHEN '%%EXCCL'.
      VALUE = RESULTAT.
  ENDCASE.
ENDFORM.
FORM GET_EXC_CL CHANGING P_EXC_CL.
   IF EX IS BOUND.
       P_EXC_CL = EX.
     ELSE.
       CLEAR P_EXC_CL.
   ENDIF.
ENDFORM.
FORM PARAMETER_READ_INPUT USING NAME
                                KEY
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'SELECTION'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ISELECTION
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ISELECTION.
    WHEN 'RESOURCE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IRESOURCE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IRESOURCE.
    WHEN 'WHO'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IWHO
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IWHO.
    WHEN 'ORDIM_CONFIRM'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IORDIM_CONFIRM
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IORDIM_CONFIRM.
    WHEN 'NESTED_HU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_INESTED_HU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_INESTED_HU.
    WHEN 'TT_ORDIM_CONFIRM'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ITT_ORDIM_CONFIRM
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ITT_ORDIM_CONFIRM.
    WHEN 'TT_NESTED_HU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ITT_NESTED_HU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ITT_NESTED_HU.
    WHEN 'T_RF_PICK_HUS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IT_RF_PICK_HUS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IT_RF_PICK_HUS.
    WHEN 'WME_VERIF'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IWME_VERIF
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IWME_VERIF.
  ENDCASE.
ENDFORM.
FORM PARAMETER_READ_OUTPUT USING NAME
                                 KEY
                        CHANGING VALUE.
  CASE NAME.
    WHEN 'SELECTION'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VSELECTION
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'RESOURCE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VRESOURCE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'WHO'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VWHO
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'ORDIM_CONFIRM'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VORDIM_CONFIRM
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'NESTED_HU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VNESTED_HU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'TT_ORDIM_CONFIRM'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VTT_ORDIM_CONFIRM
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'TT_NESTED_HU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VTT_NESTED_HU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'T_RF_PICK_HUS'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VT_RF_PICK_HUS
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'WME_VERIF'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VWME_VERIF
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  ENDCASE.
ENDFORM.
FORM PARAMETER_COMPARE USING NAME
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'SELECTION'.
      IF %_OSELECTION &lt;&gt; %_VSELECTION.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'RESOURCE'.
      IF %_ORESOURCE &lt;&gt; %_VRESOURCE.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'WHO'.
      IF %_OWHO &lt;&gt; %_VWHO.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'ORDIM_CONFIRM'.
      IF %_OORDIM_CONFIRM &lt;&gt; %_VORDIM_CONFIRM.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'NESTED_HU'.
      IF %_ONESTED_HU &lt;&gt; %_VNESTED_HU.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'TT_ORDIM_CONFIRM'.
      IF %_OTT_ORDIM_CONFIRM &lt;&gt; %_VTT_ORDIM_CONFIRM.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'TT_NESTED_HU'.
      IF %_OTT_NESTED_HU &lt;&gt; %_VTT_NESTED_HU.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'T_RF_PICK_HUS'.
      IF %_OT_RF_PICK_HUS &lt;&gt; %_VT_RF_PICK_HUS.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'WME_VERIF'.
      IF %_OWME_VERIF &lt;&gt; %_VWME_VERIF.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT_MEMORY USING SEL KEY STRUCTURE EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_ISELECTION
%_IRESOURCE
%_IWHO
%_IORDIM_CONFIRM
%_INESTED_HU
%_ITT_ORDIM_CONFIRM
%_ITT_NESTED_HU
%_IT_RF_PICK_HUS
%_IWME_VERIF
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VSELECTION = %_OSELECTION.
%_VRESOURCE = %_ORESOURCE.
%_VWHO = %_OWHO.
%_VORDIM_CONFIRM = %_OORDIM_CONFIRM.
%_VNESTED_HU = %_ONESTED_HU.
%_VTT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM.
%_VTT_NESTED_HU = %_OTT_NESTED_HU.
%_VT_RF_PICK_HUS = %_OT_RF_PICK_HUS.
%_VWME_VERIF = %_OWME_VERIF.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_ISELECTION
%_IRESOURCE
%_IWHO
%_IORDIM_CONFIRM
%_INESTED_HU
%_ITT_ORDIM_CONFIRM
%_ITT_NESTED_HU
%_IT_RF_PICK_HUS
%_IWME_VERIF
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VSELECTION = %_OSELECTION.
%_VRESOURCE = %_ORESOURCE.
%_VWHO = %_OWHO.
%_VORDIM_CONFIRM = %_OORDIM_CONFIRM.
%_VNESTED_HU = %_ONESTED_HU.
%_VTT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM.
%_VTT_NESTED_HU = %_OTT_NESTED_HU.
%_VT_RF_PICK_HUS = %_OT_RF_PICK_HUS.
%_VWME_VERIF = %_OWME_VERIF.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
RC = V_RC.
%_OSELECTION = %_VSELECTION.
%_ORESOURCE = %_VRESOURCE.
%_OWHO = %_VWHO.
%_OORDIM_CONFIRM = %_VORDIM_CONFIRM.
%_ONESTED_HU = %_VNESTED_HU.
%_OTT_ORDIM_CONFIRM = %_VTT_ORDIM_CONFIRM.
%_OTT_NESTED_HU = %_VTT_NESTED_HU.
%_OT_RF_PICK_HUS = %_VT_RF_PICK_HUS.
%_OWME_VERIF = %_VWME_VERIF.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT USING SEL KEY STRUCTURE D102N_EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_ISELECTION
%_IRESOURCE
%_IWHO
%_IORDIM_CONFIRM
%_INESTED_HU
%_ITT_ORDIM_CONFIRM
%_ITT_NESTED_HU
%_IT_RF_PICK_HUS
%_IWME_VERIF
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VSELECTION = %_OSELECTION.
%_VRESOURCE = %_ORESOURCE.
%_VWHO = %_OWHO.
%_VORDIM_CONFIRM = %_OORDIM_CONFIRM.
%_VNESTED_HU = %_ONESTED_HU.
%_VTT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM.
%_VTT_NESTED_HU = %_OTT_NESTED_HU.
%_VT_RF_PICK_HUS = %_OT_RF_PICK_HUS.
%_VWME_VERIF = %_OWME_VERIF.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_ISELECTION
%_IRESOURCE
%_IWHO
%_IORDIM_CONFIRM
%_INESTED_HU
%_ITT_ORDIM_CONFIRM
%_ITT_NESTED_HU
%_IT_RF_PICK_HUS
%_IWME_VERIF
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VSELECTION = %_OSELECTION.
%_VRESOURCE = %_ORESOURCE.
%_VWHO = %_OWHO.
%_VORDIM_CONFIRM = %_OORDIM_CONFIRM.
%_VNESTED_HU = %_ONESTED_HU.
%_VTT_ORDIM_CONFIRM = %_OTT_ORDIM_CONFIRM.
%_VTT_NESTED_HU = %_OTT_NESTED_HU.
%_VT_RF_PICK_HUS = %_OT_RF_PICK_HUS.
%_VWME_VERIF = %_OWME_VERIF.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_OSELECTION
%_VSELECTION
%_ORESOURCE
%_VRESOURCE
%_OWHO
%_VWHO
%_OORDIM_CONFIRM
%_VORDIM_CONFIRM
%_ONESTED_HU
%_VNESTED_HU
%_OTT_ORDIM_CONFIRM
%_VTT_ORDIM_CONFIRM
%_OTT_NESTED_HU
%_VTT_NESTED_HU
%_OT_RF_PICK_HUS
%_VT_RF_PICK_HUS
%_OWME_VERIF
%_VWME_VERIF
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
RC = V_RC.
%_OSELECTION = %_VSELECTION.
%_ORESOURCE = %_VRESOURCE.
%_OWHO = %_VWHO.
%_OORDIM_CONFIRM = %_VORDIM_CONFIRM.
%_ONESTED_HU = %_VNESTED_HU.
%_OTT_ORDIM_CONFIRM = %_VTT_ORDIM_CONFIRM.
%_OTT_NESTED_HU = %_VTT_NESTED_HU.
%_OT_RF_PICK_HUS = %_VT_RF_PICK_HUS.
%_OWME_VERIF = %_VWME_VERIF.
  ENDCASE.
ENDFORM.
FORM GET_EXCEPTION_DIFFERENCE
 TABLES DIFFERENCES STRUCTURE UNTERSCHIED.
 IF VEXCEPTION NE OEXCEPTION.
   MOVE 'EXCEPTION' TO DIFFERENCES-PARAMETER.
   IF VEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-ALT.
   ELSE.
     MOVE VEXCEPTION TO DIFFERENCES-ALT.
   ENDIF.
   IF OEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-NEU.
   ELSE.
     MOVE OEXCEPTION TO DIFFERENCES-NEU.
   ENDIF.
   APPEND DIFFERENCES.
  ENDIF.
ENDFORM.
FORM COMPARE_DATA
                  TABLES DIFFERENCES STRUCTURE UNTERSCHIED
                  USING FIELD
                  CHANGING RETCODE.
 DATA : SUBRC LIKE SY-SUBRC.
 field-symbols: &lt;l_f1&gt; type x.
 field-symbols: &lt;l_f2&gt; type x.
 RETCODE = '='.
 CLEAR DIFFERENCES.
 CASE FIELD.
WHEN 'EXCEPTION'.
IF VEXCEPTION NE OEXCEPTION.
RETCODE = SPACE.
MOVE FIELD      TO DIFFERENCES-PARAMETER.
MOVE VEXCEPTION TO DIFFERENCES-ALT.
MOVE OEXCEPTION TO DIFFERENCES-NEU.
APPEND DIFFERENCES.
ENDIF.
  ENDCASE.
ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 757
</font>
</body>
</html>
