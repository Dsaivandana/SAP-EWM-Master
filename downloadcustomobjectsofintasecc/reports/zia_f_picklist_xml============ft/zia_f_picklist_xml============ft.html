<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZIA_F_PICKLIST_XML============FT</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZIA_F_PICKLIST_XML============FT</b></font>
<hr>
<pre width="100">
REPORT ZIA_F_PICKLIST_XML============FT.
<font color ="#0000FF">* 2.0</font>
<font color ="#0000FF">*</font>
DATA: TIME1 TYPE P, TIME2 TYPE P, RUNTIME(30), DEBUG, ATRA.
DATA: RC LIKE SY-SUBRC , V_RC LIKE SY-SUBRC.
DATA: DESTI LIKE RFCDES-RFCDEST.
DATA: FIELDNAME LIKE SY-REPID.
DATA: G_UPPER TYPE C.         "Gross/Kleinschreibung
<font color ="#0000FF">*</font>
TABLES : EUFUNC.
DATA: BEGIN OF UNTERSCHIED,            " Unterschiede bei Testdur
        PARAMETER(30),
        ALT(200),
        NEU(200),                      " laufen
      END OF UNTERSCHIED.
<font color ="#0000FF">*</font>
DATA : D102N_EXPORTKEY LIKE FUNCTDIR.
<font color ="#0000FF">*</font>
DATA : BEGIN OF EXPORTKEY,
         DATAID LIKE EUFUNC-NUMMER,
         SEQID  LIKE EUFUNC-SEQID,
       END OF EXPORTKEY.
DATA : BEGIN OF EXCEPTIONS OCCURS 10,
         NAME(30),
       END OF EXCEPTIONS.
DATA : VEXCEPTION(30).
DATA : OEXCEPTION(30).
DATA : NR2(250) TYPE C.
DATA : TABLEN TYPE I.
DATA : EX TYPE REF TO CX_ROOT.
DATA : DESCR_REF TYPE REF TO CL_ABAP_TYPEDESCR.
DATA : RESULTAT(30) TYPE C.
DATA : REST(30)     TYPE C.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_IIT_HEADER OCCURS 1.
        include structure <a href ="zia_s_picklist_hdr/dictionary-zia_s_picklist_hdr.html">ZIA_S_PICKLIST_HDR</a>.
DATA: END OF %_IIT_HEADER.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_OIT_HEADER OCCURS 1.
        include structure <a href ="zia_s_picklist_hdr/dictionary-zia_s_picklist_hdr.html">ZIA_S_PICKLIST_HDR</a>.
DATA: END OF %_OIT_HEADER.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_VIT_HEADER OCCURS 1.
        include structure <a href ="zia_s_picklist_hdr/dictionary-zia_s_picklist_hdr.html">ZIA_S_PICKLIST_HDR</a>.
DATA: END OF %_VIT_HEADER.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_IIT_BLIITO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_IIT_BLIITO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_OIT_BLIITO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_OIT_BLIITO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_VIT_BLIITO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_VIT_BLIITO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_IIT_SHIPTO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_IIT_SHIPTO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_OIT_SHIPTO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_OIT_SHIPTO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_VIT_SHIPTO OCCURS 1.
        include structure <a href ="zia_s_picklist_cust/dictionary-zia_s_picklist_cust.html">ZIA_S_PICKLIST_CUST</a>.
DATA: END OF %_VIT_SHIPTO.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_IIT_ITEM OCCURS 1.
        include structure <a href ="zia_s_picklist_itm/dictionary-zia_s_picklist_itm.html">ZIA_S_PICKLIST_ITM</a>.
DATA: END OF %_IIT_ITEM.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_OIT_ITEM OCCURS 1.
        include structure <a href ="zia_s_picklist_itm/dictionary-zia_s_picklist_itm.html">ZIA_S_PICKLIST_ITM</a>.
DATA: END OF %_OIT_ITEM.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_VIT_ITEM OCCURS 1.
        include structure <a href ="zia_s_picklist_itm/dictionary-zia_s_picklist_itm.html">ZIA_S_PICKLIST_ITM</a>.
DATA: END OF %_VIT_ITEM.
<font color ="#0000FF">*</font>
DATA: COMMUNICATION_FAILURE(1).
<font color ="#0000FF">*</font>
DATA: SYSTEM_FAILURE(1).
<font color ="#0000FF">*</font>
FORM EXISTENCE_CHECK CHANGING VARIA.
  VARIA = 1.
ENDFORM.
FORM FUNCTION_CALL.
CLEAR %_OIT_HEADER.
REFRESH %_OIT_HEADER.
LOOP AT %_IIT_HEADER.
  %_OIT_HEADER = %_IIT_HEADER.
  APPEND %_OIT_HEADER.
ENDLOOP.
CLEAR %_OIT_BLIITO.
REFRESH %_OIT_BLIITO.
LOOP AT %_IIT_BLIITO.
  %_OIT_BLIITO = %_IIT_BLIITO.
  APPEND %_OIT_BLIITO.
ENDLOOP.
CLEAR %_OIT_SHIPTO.
REFRESH %_OIT_SHIPTO.
LOOP AT %_IIT_SHIPTO.
  %_OIT_SHIPTO = %_IIT_SHIPTO.
  APPEND %_OIT_SHIPTO.
ENDLOOP.
CLEAR %_OIT_ITEM.
REFRESH %_OIT_ITEM.
LOOP AT %_IIT_ITEM.
  %_OIT_ITEM = %_IIT_ITEM.
  APPEND %_OIT_ITEM.
ENDLOOP.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI IS INITIAL.
IF DEBUG = '1'. BREAK-POINT AT NEXT APPLICATION STATEMENT.
ENDIF.
DEBUG = SPACE.
GET RUN TIME FIELD TIME1.
CALL FUNCTION 'ZIA_F_PICKLIST_XML'
TABLES
IT_HEADER = %_OIT_HEADER
IT_BLIITO = %_OIT_BLIITO
IT_SHIPTO = %_OIT_SHIPTO
IT_ITEM = %_OIT_ITEM
EXCEPTIONS
COMMUNICATION_FAILURE = 001
SYSTEM_FAILURE = 002.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
ELSE.
GET RUN TIME FIELD TIME1.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI = 'SPACE'.
  DESTI = ' '.
ENDIF.
CALL FUNCTION 'ZIA_F_PICKLIST_XML' DESTINATION DESTI
TABLES
IT_HEADER = %_OIT_HEADER
IT_BLIITO = %_OIT_BLIITO
IT_SHIPTO = %_OIT_SHIPTO
IT_ITEM = %_OIT_ITEM
EXCEPTIONS
COMMUNICATION_FAILURE = 001
SYSTEM_FAILURE = 002.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
  ENDIF.
  GET RUN TIME FIELD TIME2.
  RC = SY-SUBRC.
  CLEAR EXCEPTIONS.
  READ TABLE EXCEPTIONS INDEX RC.
  IF SY-SUBRC = 0.
  OEXCEPTION = EXCEPTIONS-NAME.
  ELSE.
  OEXCEPTION = RESULTAT.
  ENDIF.
  TIME1 = TIME2 - TIME1.
  WRITE TIME1 TO RUNTIME.
  CONDENSE RUNTIME.
ENDFORM.

FORM CLEAR_DATA.
ENDFORM.
FORM CLEAR_TABLE.
CLEAR %_IIT_HEADER.
REFRESH %_IIT_HEADER.
CLEAR %_IIT_BLIITO.
REFRESH %_IIT_BLIITO.
CLEAR %_IIT_SHIPTO.
REFRESH %_IIT_SHIPTO.
CLEAR %_IIT_ITEM.
REFRESH %_IIT_ITEM.
ENDFORM.
FORM DELETE_LINE USING KEY INDEX.
CASE KEY.
WHEN 'IT_HEADER'.
READ TABLE %_IIT_HEADER INDEX INDEX.
IF SY-SUBRC = 0.
DELETE %_IIT_HEADER INDEX INDEX.
ENDIF.
WHEN 'IT_BLIITO'.
READ TABLE %_IIT_BLIITO INDEX INDEX.
IF SY-SUBRC = 0.
DELETE %_IIT_BLIITO INDEX INDEX.
ENDIF.
WHEN 'IT_SHIPTO'.
READ TABLE %_IIT_SHIPTO INDEX INDEX.
IF SY-SUBRC = 0.
DELETE %_IIT_SHIPTO INDEX INDEX.
ENDIF.
WHEN 'IT_ITEM'.
READ TABLE %_IIT_ITEM INDEX INDEX.
IF SY-SUBRC = 0.
DELETE %_IIT_ITEM INDEX INDEX.
ENDIF.
ENDCASE.
ENDFORM.
FORM INIT_EXCEPTIONS USING NAME.
  CLEAR EXCEPTIONS.
  MOVE NAME TO EXCEPTIONS-NAME.
  APPEND EXCEPTIONS.
ENDFORM.
FORM PARAM_ACCESS_TYPES USING KEY DEST P_MODE P_UPPER.
DATA : INTKEY(31).
  P_UPPER = G_UPPER.
  INTKEY = DEST.
  INTKEY+1 = KEY.
  CONDENSE INTKEY.
  CASE INTKEY.
    WHEN 'IIT_HEADER'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_HEADER'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIT_HEADER[].
    WHEN 'OIT_HEADER'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_HEADER'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OIT_HEADER[].
    WHEN 'VIT_HEADER'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_HEADER'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VIT_HEADER[].
    WHEN 'IIT_BLIITO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_BLIITO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIT_BLIITO[].
    WHEN 'OIT_BLIITO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_BLIITO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OIT_BLIITO[].
    WHEN 'VIT_BLIITO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_BLIITO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VIT_BLIITO[].
    WHEN 'IIT_SHIPTO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_SHIPTO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIT_SHIPTO[].
    WHEN 'OIT_SHIPTO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_SHIPTO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OIT_SHIPTO[].
    WHEN 'VIT_SHIPTO'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_SHIPTO'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VIT_SHIPTO[].
    WHEN 'IIT_ITEM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_ITEM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IIT_ITEM[].
    WHEN 'OIT_ITEM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_ITEM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OIT_ITEM[].
    WHEN 'VIT_ITEM'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'IT_ITEM'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VIT_ITEM[].
  ENDCASE.
ENDFORM.
FORM PARAMETER_SET USING NAME DIRECTION VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_GET USING NAME DIRECTION
                   CHANGING   VALUE
                            OLD_VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'OIT_HEADER'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OIT_HEADER[]
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIT_HEADER[]
   CHANGING OLD_VALUE.
WHEN 'OIT_BLIITO'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OIT_BLIITO[]
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIT_BLIITO[]
   CHANGING OLD_VALUE.
WHEN 'OIT_SHIPTO'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OIT_SHIPTO[]
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIT_SHIPTO[]
   CHANGING OLD_VALUE.
WHEN 'OIT_ITEM'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OIT_ITEM[]
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IIT_ITEM[]
   CHANGING OLD_VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_SET USING NAME VALUE.
CASE NAME.
WHEN 'IT_HEADER'.
  %_OIT_HEADER[] = VALUE.
WHEN 'IT_BLIITO'.
  %_OIT_BLIITO[] = VALUE.
WHEN 'IT_SHIPTO'.
  %_OIT_SHIPTO[] = VALUE.
WHEN 'IT_ITEM'.
  %_OIT_ITEM[] = VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_GET USING NAME
                   CHANGING   VALUE.
CASE NAME.
WHEN 'IT_HEADER'.
  VALUE = %_OIT_HEADER[].
WHEN 'IT_BLIITO'.
  VALUE = %_OIT_BLIITO[].
WHEN 'IT_SHIPTO'.
  VALUE = %_OIT_SHIPTO[].
WHEN 'IT_ITEM'.
  VALUE = %_OIT_ITEM[].
ENDCASE.
ENDFORM.
FORM PARAMETER_DESCRIBE USING CBPROG
                              NAME.
CASE NAME.
WHEN 'IT_HEADER'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OIT_HEADER
         NAME.
WHEN 'IT_BLIITO'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OIT_BLIITO
         NAME.
WHEN 'IT_SHIPTO'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OIT_SHIPTO
         NAME.
WHEN 'IT_ITEM'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OIT_ITEM
         NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_CONTAINER TABLES LCONT STRUCTURE SWCONT
                         USING NAME
                               DIRECTION .
CASE NAME.
ENDCASE.
ENDFORM.
FORM TABLES_CONTAINER TABLES LCONT STRUCTURE SWCONT
                      USING NAME
                            DIRECTION.
CASE NAME.
WHEN 'IIT_HEADER'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_HEADER
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_HEADER
CONTAINER = LCONT.
ENDIF.
WHEN 'IIT_BLIITO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_BLIITO
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_BLIITO
CONTAINER = LCONT.
ENDIF.
WHEN 'IIT_SHIPTO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_SHIPTO
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_SHIPTO
CONTAINER = LCONT.
ENDIF.
WHEN 'IIT_ITEM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_ITEM
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IIT_ITEM
CONTAINER = LCONT.
ENDIF.
WHEN 'OIT_HEADER'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_HEADER
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_HEADER
CONTAINER = LCONT.
ENDIF.
WHEN 'OIT_BLIITO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_BLIITO
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_BLIITO
CONTAINER = LCONT.
ENDIF.
WHEN 'OIT_SHIPTO'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_SHIPTO
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_SHIPTO
CONTAINER = LCONT.
ENDIF.
WHEN 'OIT_ITEM'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_ITEM
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OIT_ITEM
CONTAINER = LCONT.
ENDIF.
ENDCASE.
ENDFORM.
FORM SET_VARIABLES USING KEY VALUE.
  CASE KEY.
    WHEN '%%DEBUGON'.
      DEBUG = 1.
    WHEN '%%DEBUGOFF'.
      DEBUG = 0.
    WHEN '%%DESTI'.
      DESTI = VALUE.
    WHEN '%%ATRAON'.
      ATRA = 1.
    WHEN '%%ATRAOFF'.
      ATRA = 0.
    WHEN '%%UPPER'.
      G_UPPER = VALUE.
  ENDCASE.
ENDFORM.
FORM GET_VARIABLES USING    KEY
                   CHANGING VALUE.
  CASE KEY.
    WHEN '%%DEBUG'.
      VALUE = DEBUG.
    WHEN '%%DESTI'.
      VALUE = DESTI.
    WHEN '%%ATRA'.
      VALUE = ATRA.
    WHEN '%%SUBRC'.
      VALUE = RC.
    WHEN 'V%%SUBRC'.
      VALUE = V_RC.
    WHEN '%%TIME'.
      VALUE = RUNTIME.
    WHEN '%%UPPER'.
      VALUE = G_UPPER.
    WHEN '%%EXCCL'.
      VALUE = RESULTAT.
  ENDCASE.
ENDFORM.
FORM GET_EXC_CL CHANGING P_EXC_CL.
   IF EX IS BOUND.
       P_EXC_CL = EX.
     ELSE.
       CLEAR P_EXC_CL.
   ENDIF.
ENDFORM.
FORM PARAMETER_READ_INPUT USING NAME
                                KEY
                       CHANGING VALUE.
  CASE NAME.
  ENDCASE.
ENDFORM.
FORM PARAMETER_READ_OUTPUT USING NAME
                                 KEY
                        CHANGING VALUE.
  CASE NAME.
  ENDCASE.
ENDFORM.
FORM PARAMETER_COMPARE USING NAME
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'IT_HEADER'.
      IF %_OIT_HEADER[] &lt;&gt; %_VIT_HEADER[].
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'IT_BLIITO'.
      IF %_OIT_BLIITO[] &lt;&gt; %_VIT_BLIITO[].
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'IT_SHIPTO'.
      IF %_OIT_SHIPTO[] &lt;&gt; %_VIT_SHIPTO[].
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'IT_ITEM'.
      IF %_OIT_ITEM[] &lt;&gt; %_VIT_ITEM[].
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT_MEMORY USING SEL KEY STRUCTURE EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_IIT_HEADER
%_IIT_BLIITO
%_IIT_SHIPTO
%_IIT_ITEM
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
CLEAR %_VIT_HEADER.
REFRESH %_VIT_HEADER.
LOOP AT %_OIT_HEADER.
  %_VIT_HEADER = %_OIT_HEADER.
  APPEND %_VIT_HEADER.
ENDLOOP.
CLEAR %_VIT_BLIITO.
REFRESH %_VIT_BLIITO.
LOOP AT %_OIT_BLIITO.
  %_VIT_BLIITO = %_OIT_BLIITO.
  APPEND %_VIT_BLIITO.
ENDLOOP.
CLEAR %_VIT_SHIPTO.
REFRESH %_VIT_SHIPTO.
LOOP AT %_OIT_SHIPTO.
  %_VIT_SHIPTO = %_OIT_SHIPTO.
  APPEND %_VIT_SHIPTO.
ENDLOOP.
CLEAR %_VIT_ITEM.
REFRESH %_VIT_ITEM.
LOOP AT %_OIT_ITEM.
  %_VIT_ITEM = %_OIT_ITEM.
  APPEND %_VIT_ITEM.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_IIT_HEADER
%_IIT_BLIITO
%_IIT_SHIPTO
%_IIT_ITEM
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
CLEAR %_VIT_HEADER.
REFRESH %_VIT_HEADER.
LOOP AT %_OIT_HEADER.
  %_VIT_HEADER = %_OIT_HEADER.
  APPEND %_VIT_HEADER.
ENDLOOP.
CLEAR %_VIT_BLIITO.
REFRESH %_VIT_BLIITO.
LOOP AT %_OIT_BLIITO.
  %_VIT_BLIITO = %_OIT_BLIITO.
  APPEND %_VIT_BLIITO.
ENDLOOP.
CLEAR %_VIT_SHIPTO.
REFRESH %_VIT_SHIPTO.
LOOP AT %_OIT_SHIPTO.
  %_VIT_SHIPTO = %_OIT_SHIPTO.
  APPEND %_VIT_SHIPTO.
ENDLOOP.
CLEAR %_VIT_ITEM.
REFRESH %_VIT_ITEM.
LOOP AT %_OIT_ITEM.
  %_VIT_ITEM = %_OIT_ITEM.
  APPEND %_VIT_ITEM.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
RC = V_RC.
CLEAR %_OIT_HEADER.
REFRESH %_OIT_HEADER.
LOOP AT %_VIT_HEADER.
  %_OIT_HEADER = %_VIT_HEADER.
  APPEND %_OIT_HEADER.
ENDLOOP.
CLEAR %_OIT_BLIITO.
REFRESH %_OIT_BLIITO.
LOOP AT %_VIT_BLIITO.
  %_OIT_BLIITO = %_VIT_BLIITO.
  APPEND %_OIT_BLIITO.
ENDLOOP.
CLEAR %_OIT_SHIPTO.
REFRESH %_OIT_SHIPTO.
LOOP AT %_VIT_SHIPTO.
  %_OIT_SHIPTO = %_VIT_SHIPTO.
  APPEND %_OIT_SHIPTO.
ENDLOOP.
CLEAR %_OIT_ITEM.
REFRESH %_OIT_ITEM.
LOOP AT %_VIT_ITEM.
  %_OIT_ITEM = %_VIT_ITEM.
  APPEND %_OIT_ITEM.
ENDLOOP.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT USING SEL KEY STRUCTURE D102N_EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_IIT_HEADER
%_IIT_BLIITO
%_IIT_SHIPTO
%_IIT_ITEM
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
CLEAR %_VIT_HEADER.
REFRESH %_VIT_HEADER.
LOOP AT %_OIT_HEADER.
  %_VIT_HEADER = %_OIT_HEADER.
  APPEND %_VIT_HEADER.
ENDLOOP.
CLEAR %_VIT_BLIITO.
REFRESH %_VIT_BLIITO.
LOOP AT %_OIT_BLIITO.
  %_VIT_BLIITO = %_OIT_BLIITO.
  APPEND %_VIT_BLIITO.
ENDLOOP.
CLEAR %_VIT_SHIPTO.
REFRESH %_VIT_SHIPTO.
LOOP AT %_OIT_SHIPTO.
  %_VIT_SHIPTO = %_OIT_SHIPTO.
  APPEND %_VIT_SHIPTO.
ENDLOOP.
CLEAR %_VIT_ITEM.
REFRESH %_VIT_ITEM.
LOOP AT %_OIT_ITEM.
  %_VIT_ITEM = %_OIT_ITEM.
  APPEND %_VIT_ITEM.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_IIT_HEADER
%_IIT_BLIITO
%_IIT_SHIPTO
%_IIT_ITEM
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
CLEAR %_VIT_HEADER.
REFRESH %_VIT_HEADER.
LOOP AT %_OIT_HEADER.
  %_VIT_HEADER = %_OIT_HEADER.
  APPEND %_VIT_HEADER.
ENDLOOP.
CLEAR %_VIT_BLIITO.
REFRESH %_VIT_BLIITO.
LOOP AT %_OIT_BLIITO.
  %_VIT_BLIITO = %_OIT_BLIITO.
  APPEND %_VIT_BLIITO.
ENDLOOP.
CLEAR %_VIT_SHIPTO.
REFRESH %_VIT_SHIPTO.
LOOP AT %_OIT_SHIPTO.
  %_VIT_SHIPTO = %_OIT_SHIPTO.
  APPEND %_VIT_SHIPTO.
ENDLOOP.
CLEAR %_VIT_ITEM.
REFRESH %_VIT_ITEM.
LOOP AT %_OIT_ITEM.
  %_VIT_ITEM = %_OIT_ITEM.
  APPEND %_VIT_ITEM.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VIT_HEADER
%_VIT_BLIITO
%_VIT_SHIPTO
%_VIT_ITEM
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
RC = V_RC.
CLEAR %_OIT_HEADER.
REFRESH %_OIT_HEADER.
LOOP AT %_VIT_HEADER.
  %_OIT_HEADER = %_VIT_HEADER.
  APPEND %_OIT_HEADER.
ENDLOOP.
CLEAR %_OIT_BLIITO.
REFRESH %_OIT_BLIITO.
LOOP AT %_VIT_BLIITO.
  %_OIT_BLIITO = %_VIT_BLIITO.
  APPEND %_OIT_BLIITO.
ENDLOOP.
CLEAR %_OIT_SHIPTO.
REFRESH %_OIT_SHIPTO.
LOOP AT %_VIT_SHIPTO.
  %_OIT_SHIPTO = %_VIT_SHIPTO.
  APPEND %_OIT_SHIPTO.
ENDLOOP.
CLEAR %_OIT_ITEM.
REFRESH %_OIT_ITEM.
LOOP AT %_VIT_ITEM.
  %_OIT_ITEM = %_VIT_ITEM.
  APPEND %_OIT_ITEM.
ENDLOOP.
  ENDCASE.
ENDFORM.
FORM GET_EXCEPTION_DIFFERENCE
 TABLES DIFFERENCES STRUCTURE UNTERSCHIED.
 IF VEXCEPTION NE OEXCEPTION.
   MOVE 'EXCEPTION' TO DIFFERENCES-PARAMETER.
   IF VEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-ALT.
   ELSE.
     MOVE VEXCEPTION TO DIFFERENCES-ALT.
   ENDIF.
   IF OEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-NEU.
   ELSE.
     MOVE OEXCEPTION TO DIFFERENCES-NEU.
   ENDIF.
   APPEND DIFFERENCES.
  ENDIF.
ENDFORM.
FORM COMPARE_DATA
                  TABLES DIFFERENCES STRUCTURE UNTERSCHIED
                  USING FIELD
                  CHANGING RETCODE.
 DATA : SUBRC LIKE SY-SUBRC.
 field-symbols: &lt;l_f1&gt; type x.
 field-symbols: &lt;l_f2&gt; type x.
 RETCODE = '='.
 CLEAR DIFFERENCES.
 CASE FIELD.
WHEN 'IT_HEADER'.
DO.
READ TABLE %_OIT_HEADER INDEX SY-INDEX.
SUBRC = SY-SUBRC.
READ TABLE %_VIT_HEADER INDEX SY-INDEX.
IF SY-SUBRC NE 0 AND SUBRC NE 0.
EXIT.
ELSEIF SY-SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_OIT_HEADER to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_HEADER to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF %_VIT_HEADER
NE %_OIT_HEADER.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_HEADER to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OIT_HEADER to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ENDIF.
ENDDO.
WHEN 'IT_BLIITO'.
DO.
READ TABLE %_OIT_BLIITO INDEX SY-INDEX.
SUBRC = SY-SUBRC.
READ TABLE %_VIT_BLIITO INDEX SY-INDEX.
IF SY-SUBRC NE 0 AND SUBRC NE 0.
EXIT.
ELSEIF SY-SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_OIT_BLIITO to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_BLIITO to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF %_VIT_BLIITO
NE %_OIT_BLIITO.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_BLIITO to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OIT_BLIITO to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ENDIF.
ENDDO.
WHEN 'IT_SHIPTO'.
DO.
READ TABLE %_OIT_SHIPTO INDEX SY-INDEX.
SUBRC = SY-SUBRC.
READ TABLE %_VIT_SHIPTO INDEX SY-INDEX.
IF SY-SUBRC NE 0 AND SUBRC NE 0.
EXIT.
ELSEIF SY-SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_OIT_SHIPTO to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_SHIPTO to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF %_VIT_SHIPTO
NE %_OIT_SHIPTO.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_SHIPTO to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OIT_SHIPTO to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ENDIF.
ENDDO.
WHEN 'IT_ITEM'.
DO.
READ TABLE %_OIT_ITEM INDEX SY-INDEX.
SUBRC = SY-SUBRC.
READ TABLE %_VIT_ITEM INDEX SY-INDEX.
IF SY-SUBRC NE 0 AND SUBRC NE 0.
EXIT.
ELSEIF SY-SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_OIT_ITEM to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_ITEM to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF %_VIT_ITEM
NE %_OIT_ITEM.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VIT_ITEM to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OIT_ITEM to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ENDIF.
ENDDO.
WHEN 'EXCEPTION'.
IF VEXCEPTION NE OEXCEPTION.
RETCODE = SPACE.
MOVE FIELD      TO DIFFERENCES-PARAMETER.
MOVE VEXCEPTION TO DIFFERENCES-ALT.
MOVE OEXCEPTION TO DIFFERENCES-NEU.
APPEND DIFFERENCES.
ENDIF.
  ENDCASE.
ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 750
</font>
</body>
</html>
