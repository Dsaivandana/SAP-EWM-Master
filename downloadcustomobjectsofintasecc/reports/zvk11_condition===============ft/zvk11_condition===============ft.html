<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>
<head>
<title>ZVK11_CONDITION===============FT</title>
</head>
<body bgcolor="#FFFFE0">
<font size="3" face = "Arial" color="#000000"><b>Code listing for: ZVK11_CONDITION===============FT</b></font>
<hr>
<pre width="100">
REPORT ZVK11_CONDITION===============FT.
<font color ="#0000FF">* 2.0</font>
<font color ="#0000FF">*</font>
DATA: TIME1 TYPE P, TIME2 TYPE P, RUNTIME(30), DEBUG, ATRA.
DATA: RC LIKE SY-SUBRC , V_RC LIKE SY-SUBRC.
DATA: DESTI LIKE RFCDES-RFCDEST.
DATA: FIELDNAME LIKE SY-REPID.
DATA: G_UPPER TYPE C.         "Gross/Kleinschreibung
<font color ="#0000FF">*</font>
TABLES : EUFUNC.
DATA: BEGIN OF UNTERSCHIED,            " Unterschiede bei Testdur
        PARAMETER(30),
        ALT(200),
        NEU(200),                      " laufen
      END OF UNTERSCHIED.
<font color ="#0000FF">*</font>
DATA : D102N_EXPORTKEY LIKE FUNCTDIR.
<font color ="#0000FF">*</font>
DATA : BEGIN OF EXPORTKEY,
         DATAID LIKE EUFUNC-NUMMER,
         SEQID  LIKE EUFUNC-SEQID,
       END OF EXPORTKEY.
DATA : BEGIN OF EXCEPTIONS OCCURS 10,
         NAME(30),
       END OF EXCEPTIONS.
DATA : VEXCEPTION(30).
DATA : OEXCEPTION(30).
DATA : NR2(250) TYPE C.
DATA : TABLEN TYPE I.
DATA : EX TYPE REF TO CX_ROOT.
DATA : DESCR_REF TYPE REF TO CL_ABAP_TYPEDESCR.
DATA : RESULTAT(30) TYPE C.
DATA : REST(30)     TYPE C.
<font color ="#0000FF">*</font>
DATA: %_ICTU LIKE APQI-PUTACTIVE VALUE 'X'.
DATA: %_IMODE LIKE APQI-PUTACTIVE VALUE 'N'.
DATA: %_IUPDATE LIKE APQI-PUTACTIVE VALUE 'L'.
DATA: %_IGROUP LIKE APQI-GROUPID.
DATA: %_IUSER LIKE APQI-USERID.
DATA: %_IKEEP LIKE APQI-QERASE.
DATA: %_IHOLDDATE LIKE APQI-STARTDATE.
DATA: %_INODATA LIKE APQI-PUTACTIVE VALUE '/'.
DATA: %_IKSCHL_001 LIKE BDCDATA-FVAL VALUE 'ZESP'.
DATA: %_ISELKZ_01_002 LIKE BDCDATA-FVAL VALUE ''.
DATA: %_ISELKZ_04_003 LIKE BDCDATA-FVAL VALUE 'X'.
DATA: %_IVKORG_004 LIKE BDCDATA-FVAL VALUE 'ES10'.
DATA: %_IVTWEG_005 LIKE BDCDATA-FVAL VALUE 'HX'.
DATA: %_IKUNNR_006 LIKE BDCDATA-FVAL VALUE '7000005'.
DATA: %_IMATNR_01_007 LIKE BDCDATA-FVAL VALUE '200000916'.
DATA: %_IKBETR_01_008 LIKE BDCDATA-FVAL VALUE '            0.70'.
DATA: %_IKONWA_01_009 LIKE BDCDATA-FVAL VALUE 'EUR'.
DATA: %_IKPEIN_01_010 LIKE BDCDATA-FVAL VALUE '    1'.
DATA: %_IKMEIN_01_011 LIKE BDCDATA-FVAL VALUE 'NOS'.
DATA: %_IDATAB_01_012 LIKE BDCDATA-FVAL VALUE '26.04.2019'.
DATA: %_IDATBI_01_013 LIKE BDCDATA-FVAL VALUE '31.12.9999'.
DATA: BEGIN OF %_IQUAT.
        include structure <a href ="zia_s_quat_from_aqua/dictionary-zia_s_quat_from_aqua.html">ZIA_S_QUAT_FROM_AQUA</a>.
DATA: END OF %_IQUAT.
DATA: %_IBLOCK TYPE KBSTAT.
DATA: %_OSUBRC LIKE SYST-SUBRC,
      %_VSUBRC LIKE SYST-SUBRC.
DATA: BEGIN OF %_IMESSTAB OCCURS 1.
        INCLUDE STRUCTURE BDCMSGCOLL.
DATA: END OF %_IMESSTAB.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_OMESSTAB OCCURS 1.
        INCLUDE STRUCTURE BDCMSGCOLL.
DATA: END OF %_OMESSTAB.
<font color ="#0000FF">*</font>
DATA: BEGIN OF %_VMESSTAB OCCURS 1.
        INCLUDE STRUCTURE BDCMSGCOLL.
DATA: END OF %_VMESSTAB.
<font color ="#0000FF">*</font>
DATA: COMMUNICATION_FAILURE(1).
<font color ="#0000FF">*</font>
DATA: SYSTEM_FAILURE(1).
<font color ="#0000FF">*</font>
FORM EXISTENCE_CHECK CHANGING VARIA.
  VARIA = 1.
ENDFORM.
FORM FUNCTION_CALL.
  CLEAR %_OSUBRC.
CLEAR %_OMESSTAB.
REFRESH %_OMESSTAB.
LOOP AT %_IMESSTAB.
  %_OMESSTAB = %_IMESSTAB.
  APPEND %_OMESSTAB.
ENDLOOP.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI IS INITIAL.
IF DEBUG = '1'. BREAK-POINT AT NEXT APPLICATION STATEMENT.
ENDIF.
DEBUG = SPACE.
GET RUN TIME FIELD TIME1.
CALL FUNCTION 'ZVK11_CONDITION'
EXPORTING
CTU = %_ICTU
MODE = %_IMODE
UPDATE = %_IUPDATE
GROUP = %_IGROUP
USER = %_IUSER
KEEP = %_IKEEP
HOLDDATE = %_IHOLDDATE
NODATA = %_INODATA
KSCHL_001 = %_IKSCHL_001
SELKZ_01_002 = %_ISELKZ_01_002
SELKZ_04_003 = %_ISELKZ_04_003
VKORG_004 = %_IVKORG_004
VTWEG_005 = %_IVTWEG_005
KUNNR_006 = %_IKUNNR_006
MATNR_01_007 = %_IMATNR_01_007
KBETR_01_008 = %_IKBETR_01_008
KONWA_01_009 = %_IKONWA_01_009
KPEIN_01_010 = %_IKPEIN_01_010
KMEIN_01_011 = %_IKMEIN_01_011
DATAB_01_012 = %_IDATAB_01_012
DATBI_01_013 = %_IDATBI_01_013
QUAT = %_IQUAT
BLOCK = %_IBLOCK
IMPORTING
SUBRC = %_OSUBRC
TABLES
MESSTAB = %_OMESSTAB
EXCEPTIONS
COMMUNICATION_FAILURE = 001
SYSTEM_FAILURE = 002.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
ELSE.
GET RUN TIME FIELD TIME1.
<font color ="#0000FF">*  TRANSAKTION = 'Repo', PROGRAM = REPORT</font>
  IF ATRA = '1'.
    SET RUN TIME ANALYZER ON %_INTERNAL.
  ENDIF.
IF DESTI = 'SPACE'.
  DESTI = ' '.
ENDIF.
CALL FUNCTION 'ZVK11_CONDITION' DESTINATION DESTI
EXPORTING
CTU = %_ICTU
MODE = %_IMODE
UPDATE = %_IUPDATE
GROUP = %_IGROUP
USER = %_IUSER
KEEP = %_IKEEP
HOLDDATE = %_IHOLDDATE
NODATA = %_INODATA
KSCHL_001 = %_IKSCHL_001
SELKZ_01_002 = %_ISELKZ_01_002
SELKZ_04_003 = %_ISELKZ_04_003
VKORG_004 = %_IVKORG_004
VTWEG_005 = %_IVTWEG_005
KUNNR_006 = %_IKUNNR_006
MATNR_01_007 = %_IMATNR_01_007
KBETR_01_008 = %_IKBETR_01_008
KONWA_01_009 = %_IKONWA_01_009
KPEIN_01_010 = %_IKPEIN_01_010
KMEIN_01_011 = %_IKMEIN_01_011
DATAB_01_012 = %_IDATAB_01_012
DATBI_01_013 = %_IDATBI_01_013
QUAT = %_IQUAT
BLOCK = %_IBLOCK
IMPORTING
SUBRC = %_OSUBRC
TABLES
MESSTAB = %_OMESSTAB
EXCEPTIONS
COMMUNICATION_FAILURE = 001
SYSTEM_FAILURE = 002.
  IF ATRA = '1'.
    SET RUN TIME ANALYZER OFF %_INTERNAL.
  ENDIF.
  ENDIF.
  GET RUN TIME FIELD TIME2.
  RC = SY-SUBRC.
  CLEAR EXCEPTIONS.
  READ TABLE EXCEPTIONS INDEX RC.
  IF SY-SUBRC = 0.
  OEXCEPTION = EXCEPTIONS-NAME.
  ELSE.
  OEXCEPTION = RESULTAT.
  ENDIF.
  TIME1 = TIME2 - TIME1.
  WRITE TIME1 TO RUNTIME.
  CONDENSE RUNTIME.
ENDFORM.

FORM CLEAR_DATA.
  CLEAR %_ICTU.
  CLEAR %_IMODE.
  CLEAR %_IUPDATE.
  CLEAR %_IGROUP.
  CLEAR %_IUSER.
  CLEAR %_IKEEP.
  CLEAR %_IHOLDDATE.
  CLEAR %_INODATA.
  CLEAR %_IKSCHL_001.
  CLEAR %_ISELKZ_01_002.
  CLEAR %_ISELKZ_04_003.
  CLEAR %_IVKORG_004.
  CLEAR %_IVTWEG_005.
  CLEAR %_IKUNNR_006.
  CLEAR %_IMATNR_01_007.
  CLEAR %_IKBETR_01_008.
  CLEAR %_IKONWA_01_009.
  CLEAR %_IKPEIN_01_010.
  CLEAR %_IKMEIN_01_011.
  CLEAR %_IDATAB_01_012.
  CLEAR %_IDATBI_01_013.
  CLEAR %_IQUAT.
  CLEAR %_IBLOCK.
  CLEAR %_VSUBRC.
  CLEAR %_OSUBRC.
ENDFORM.
FORM CLEAR_TABLE.
CLEAR %_IMESSTAB.
REFRESH %_IMESSTAB.
ENDFORM.
FORM DELETE_LINE USING KEY INDEX.
CASE KEY.
WHEN 'MESSTAB'.
READ TABLE %_IMESSTAB INDEX INDEX.
IF SY-SUBRC = 0.
DELETE %_IMESSTAB INDEX INDEX.
ENDIF.
ENDCASE.
ENDFORM.
FORM INIT_EXCEPTIONS USING NAME.
  CLEAR EXCEPTIONS.
  MOVE NAME TO EXCEPTIONS-NAME.
  APPEND EXCEPTIONS.
ENDFORM.
FORM PARAM_ACCESS_TYPES USING KEY DEST P_MODE P_UPPER.
DATA : INTKEY(31).
  P_UPPER = G_UPPER.
  INTKEY = DEST.
  INTKEY+1 = KEY.
  CONDENSE INTKEY.
  CASE INTKEY.
    WHEN 'ICTU'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'CTU'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ICTU.
    WHEN 'IMODE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'MODE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IMODE.
    WHEN 'IUPDATE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'UPDATE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IUPDATE.
    WHEN 'IGROUP'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'GROUP'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IGROUP.
    WHEN 'IUSER'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'USER'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IUSER.
    WHEN 'IKEEP'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KEEP'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKEEP.
    WHEN 'IHOLDDATE'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'HOLDDATE'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IHOLDDATE.
    WHEN 'INODATA'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'NODATA'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_INODATA.
    WHEN 'IKSCHL_001'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KSCHL_001'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKSCHL_001.
    WHEN 'ISELKZ_01_002'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SELKZ_01_002'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ISELKZ_01_002.
    WHEN 'ISELKZ_04_003'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SELKZ_04_003'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_ISELKZ_04_003.
    WHEN 'IVKORG_004'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'VKORG_004'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IVKORG_004.
    WHEN 'IVTWEG_005'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'VTWEG_005'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IVTWEG_005.
    WHEN 'IKUNNR_006'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KUNNR_006'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKUNNR_006.
    WHEN 'IMATNR_01_007'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'MATNR_01_007'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IMATNR_01_007.
    WHEN 'IKBETR_01_008'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KBETR_01_008'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKBETR_01_008.
    WHEN 'IKONWA_01_009'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KONWA_01_009'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKONWA_01_009.
    WHEN 'IKPEIN_01_010'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KPEIN_01_010'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKPEIN_01_010.
    WHEN 'IKMEIN_01_011'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'KMEIN_01_011'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IKMEIN_01_011.
    WHEN 'IDATAB_01_012'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'DATAB_01_012'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IDATAB_01_012.
    WHEN 'IDATBI_01_013'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'DATBI_01_013'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IDATBI_01_013.
    WHEN 'IQUAT'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'QUAT'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IQUAT.
    WHEN 'IBLOCK'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'BLOCK'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IBLOCK.
    WHEN 'OSUBRC'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SUBRC'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OSUBRC.
    WHEN 'VSUBRC'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'SUBRC'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VSUBRC.
    WHEN 'IMESSTAB'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'MESSTAB'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_IMESSTAB[].
    WHEN 'OMESSTAB'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'MESSTAB'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_OMESSTAB[].
    WHEN 'VMESSTAB'.
    CALL FUNCTION 'RS_COMPLEX_OBJECT_EDIT'
         EXPORTING
OBJECT_NAME = 'MESSTAB'
MODE = P_MODE
INSERT_TAB = 'X'
UPPER_CASE = P_UPPER
         CHANGING
OBJECT = %_VMESSTAB[].
  ENDCASE.
ENDFORM.
FORM PARAMETER_SET USING NAME DIRECTION VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'ICTU'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ICTU.
WHEN 'IMODE'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IMODE.
WHEN 'IUPDATE'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IUPDATE.
WHEN 'IGROUP'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IGROUP.
WHEN 'IUSER'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IUSER.
WHEN 'IKEEP'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKEEP.
WHEN 'IHOLDDATE'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IHOLDDATE.
WHEN 'INODATA'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_INODATA.
WHEN 'IKSCHL_001'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKSCHL_001.
WHEN 'ISELKZ_01_002'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ISELKZ_01_002.
WHEN 'ISELKZ_04_003'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_ISELKZ_04_003.
WHEN 'IVKORG_004'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IVKORG_004.
WHEN 'IVTWEG_005'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IVTWEG_005.
WHEN 'IKUNNR_006'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKUNNR_006.
WHEN 'IMATNR_01_007'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IMATNR_01_007.
WHEN 'IKBETR_01_008'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKBETR_01_008.
WHEN 'IKONWA_01_009'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKONWA_01_009.
WHEN 'IKPEIN_01_010'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKPEIN_01_010.
WHEN 'IKMEIN_01_011'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IKMEIN_01_011.
WHEN 'IDATAB_01_012'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IDATAB_01_012.
WHEN 'IDATBI_01_013'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IDATBI_01_013.
WHEN 'IQUAT'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IQUAT.
WHEN 'IBLOCK'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_IBLOCK.
WHEN 'OSUBRC'.
  PERFORM CB_CALLBACK_VALUE_SET(SAPLSEUJ)
   USING VALUE
   CHANGING %_OSUBRC.
ENDCASE.
ENDFORM.
FORM PARAMETER_GET USING NAME DIRECTION
                   CHANGING   VALUE
                            OLD_VALUE.
 DATA: L_NAME(31).
 CONCATENATE DIRECTION NAME INTO L_NAME.
CASE L_NAME.
WHEN 'ICTU'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ICTU
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ICTU
   CHANGING OLD_VALUE.
WHEN 'IMODE'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IMODE
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IMODE
   CHANGING OLD_VALUE.
WHEN 'IUPDATE'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IUPDATE
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IUPDATE
   CHANGING OLD_VALUE.
WHEN 'IGROUP'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IGROUP
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IGROUP
   CHANGING OLD_VALUE.
WHEN 'IUSER'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IUSER
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IUSER
   CHANGING OLD_VALUE.
WHEN 'IKEEP'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKEEP
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKEEP
   CHANGING OLD_VALUE.
WHEN 'IHOLDDATE'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IHOLDDATE
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IHOLDDATE
   CHANGING OLD_VALUE.
WHEN 'INODATA'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_INODATA
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_INODATA
   CHANGING OLD_VALUE.
WHEN 'IKSCHL_001'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKSCHL_001
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKSCHL_001
   CHANGING OLD_VALUE.
WHEN 'ISELKZ_01_002'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ISELKZ_01_002
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ISELKZ_01_002
   CHANGING OLD_VALUE.
WHEN 'ISELKZ_04_003'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ISELKZ_04_003
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_ISELKZ_04_003
   CHANGING OLD_VALUE.
WHEN 'IVKORG_004'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IVKORG_004
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IVKORG_004
   CHANGING OLD_VALUE.
WHEN 'IVTWEG_005'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IVTWEG_005
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IVTWEG_005
   CHANGING OLD_VALUE.
WHEN 'IKUNNR_006'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKUNNR_006
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKUNNR_006
   CHANGING OLD_VALUE.
WHEN 'IMATNR_01_007'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IMATNR_01_007
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IMATNR_01_007
   CHANGING OLD_VALUE.
WHEN 'IKBETR_01_008'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKBETR_01_008
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKBETR_01_008
   CHANGING OLD_VALUE.
WHEN 'IKONWA_01_009'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKONWA_01_009
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKONWA_01_009
   CHANGING OLD_VALUE.
WHEN 'IKPEIN_01_010'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKPEIN_01_010
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKPEIN_01_010
   CHANGING OLD_VALUE.
WHEN 'IKMEIN_01_011'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKMEIN_01_011
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IKMEIN_01_011
   CHANGING OLD_VALUE.
WHEN 'IDATAB_01_012'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IDATAB_01_012
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IDATAB_01_012
   CHANGING OLD_VALUE.
WHEN 'IDATBI_01_013'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IDATBI_01_013
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IDATBI_01_013
   CHANGING OLD_VALUE.
WHEN 'IQUAT'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IQUAT
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IQUAT
   CHANGING OLD_VALUE.
WHEN 'IBLOCK'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IBLOCK
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IBLOCK
   CHANGING OLD_VALUE.
WHEN 'OSUBRC'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OSUBRC
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OSUBRC
   CHANGING OLD_VALUE.
WHEN 'OMESSTAB'.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_OMESSTAB[]
   CHANGING VALUE.
  PERFORM CB_CALLBACK_VALUE_GET(SAPLSEUJ)
   USING %_IMESSTAB[]
   CHANGING OLD_VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_SET USING NAME VALUE.
CASE NAME.
WHEN 'MESSTAB'.
  %_OMESSTAB[] = VALUE.
ENDCASE.
ENDFORM.
FORM PARAMETER_TABLE_GET USING NAME
                   CHANGING   VALUE.
CASE NAME.
WHEN 'MESSTAB'.
  VALUE = %_OMESSTAB[].
ENDCASE.
ENDFORM.
FORM PARAMETER_DESCRIBE USING CBPROG
                              NAME.
CASE NAME.
WHEN 'CTU'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ICTU
         NAME.
WHEN 'MODE'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IMODE
         NAME.
WHEN 'UPDATE'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IUPDATE
         NAME.
WHEN 'GROUP'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IGROUP
         NAME.
WHEN 'USER'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IUSER
         NAME.
WHEN 'KEEP'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKEEP
         NAME.
WHEN 'HOLDDATE'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IHOLDDATE
         NAME.
WHEN 'NODATA'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_INODATA
         NAME.
WHEN 'KSCHL_001'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKSCHL_001
         NAME.
WHEN 'SELKZ_01_002'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ISELKZ_01_002
         NAME.
WHEN 'SELKZ_04_003'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_ISELKZ_04_003
         NAME.
WHEN 'VKORG_004'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IVKORG_004
         NAME.
WHEN 'VTWEG_005'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IVTWEG_005
         NAME.
WHEN 'KUNNR_006'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKUNNR_006
         NAME.
WHEN 'MATNR_01_007'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IMATNR_01_007
         NAME.
WHEN 'KBETR_01_008'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKBETR_01_008
         NAME.
WHEN 'KONWA_01_009'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKONWA_01_009
         NAME.
WHEN 'KPEIN_01_010'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKPEIN_01_010
         NAME.
WHEN 'KMEIN_01_011'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IKMEIN_01_011
         NAME.
WHEN 'DATAB_01_012'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IDATAB_01_012
         NAME.
WHEN 'DATBI_01_013'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IDATBI_01_013
         NAME.
WHEN 'QUAT'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IQUAT
         NAME.
WHEN 'BLOCK'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_IBLOCK
         NAME.
WHEN 'SUBRC'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OSUBRC
         NAME.
WHEN 'MESSTAB'.
  PERFORM CB_CALLBACK_DESCRIBE IN PROGRAM (CBPROG)
   USING %_OMESSTAB
         NAME.
ENDCASE.
ENDFORM.
FORM PARAMETER_CONTAINER TABLES LCONT STRUCTURE SWCONT
                         USING NAME
                               DIRECTION .
CASE NAME.
WHEN 'ICTU'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ICTU
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ICTU
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IMODE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IMODE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IMODE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IUPDATE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IUPDATE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IUPDATE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IGROUP'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IGROUP
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IGROUP
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IUSER'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IUSER
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IUSER
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKEEP'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKEEP
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKEEP
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IHOLDDATE'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IHOLDDATE
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IHOLDDATE
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'INODATA'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_INODATA
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_INODATA
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKSCHL_001'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKSCHL_001
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKSCHL_001
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ISELKZ_01_002'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ISELKZ_01_002
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ISELKZ_01_002
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'ISELKZ_04_003'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_ISELKZ_04_003
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_ISELKZ_04_003
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IVKORG_004'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IVKORG_004
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IVKORG_004
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IVTWEG_005'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IVTWEG_005
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IVTWEG_005
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKUNNR_006'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKUNNR_006
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKUNNR_006
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IMATNR_01_007'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IMATNR_01_007
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IMATNR_01_007
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKBETR_01_008'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKBETR_01_008
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKBETR_01_008
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKONWA_01_009'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKONWA_01_009
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKONWA_01_009
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKPEIN_01_010'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKPEIN_01_010
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKPEIN_01_010
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IKMEIN_01_011'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IKMEIN_01_011
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IKMEIN_01_011
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IDATAB_01_012'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IDATAB_01_012
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IDATAB_01_012
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IDATBI_01_013'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IDATBI_01_013
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IDATBI_01_013
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IQUAT'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IQUAT
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IQUAT
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'IBLOCK'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_IBLOCK
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_IBLOCK
TABLES
CONTAINER = LCONT.
ENDIF.
WHEN 'OSUBRC'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_ELEMENT_SET'
EXPORTING
ELEMENT = NAME
FIELD   = %_OSUBRC
TABLES
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_ELEMENT_GET'
EXPORTING
ELEMENT = NAME
IMPORTING
FIELD   = %_OSUBRC
TABLES
CONTAINER = LCONT.
ENDIF.
ENDCASE.
ENDFORM.
FORM TABLES_CONTAINER TABLES LCONT STRUCTURE SWCONT
                      USING NAME
                            DIRECTION.
CASE NAME.
WHEN 'IMESSTAB'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IMESSTAB
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_IMESSTAB
CONTAINER = LCONT.
ENDIF.
WHEN 'OMESSTAB'.
IF DIRECTION = 'O'.
  CALL FUNCTION 'SWC_TABLE_SET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OMESSTAB
CONTAINER = LCONT.
ELSE.
  CALL FUNCTION 'SWC_TABLE_GET'
EXPORTING
ELEMENT = NAME
TABLES
TABLE   = %_OMESSTAB
CONTAINER = LCONT.
ENDIF.
ENDCASE.
ENDFORM.
FORM SET_VARIABLES USING KEY VALUE.
  CASE KEY.
    WHEN '%%DEBUGON'.
      DEBUG = 1.
    WHEN '%%DEBUGOFF'.
      DEBUG = 0.
    WHEN '%%DESTI'.
      DESTI = VALUE.
    WHEN '%%ATRAON'.
      ATRA = 1.
    WHEN '%%ATRAOFF'.
      ATRA = 0.
    WHEN '%%UPPER'.
      G_UPPER = VALUE.
  ENDCASE.
ENDFORM.
FORM GET_VARIABLES USING    KEY
                   CHANGING VALUE.
  CASE KEY.
    WHEN '%%DEBUG'.
      VALUE = DEBUG.
    WHEN '%%DESTI'.
      VALUE = DESTI.
    WHEN '%%ATRA'.
      VALUE = ATRA.
    WHEN '%%SUBRC'.
      VALUE = RC.
    WHEN 'V%%SUBRC'.
      VALUE = V_RC.
    WHEN '%%TIME'.
      VALUE = RUNTIME.
    WHEN '%%UPPER'.
      VALUE = G_UPPER.
    WHEN '%%EXCCL'.
      VALUE = RESULTAT.
  ENDCASE.
ENDFORM.
FORM GET_EXC_CL CHANGING P_EXC_CL.
   IF EX IS BOUND.
       P_EXC_CL = EX.
     ELSE.
       CLEAR P_EXC_CL.
   ENDIF.
ENDFORM.
FORM PARAMETER_READ_INPUT USING NAME
                                KEY
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'CTU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ICTU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ICTU.
    WHEN 'MODE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IMODE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IMODE.
    WHEN 'UPDATE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IUPDATE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IUPDATE.
    WHEN 'GROUP'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IGROUP
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IGROUP.
    WHEN 'USER'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IUSER
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IUSER.
    WHEN 'KEEP'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKEEP
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKEEP.
    WHEN 'HOLDDATE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IHOLDDATE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IHOLDDATE.
    WHEN 'NODATA'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_INODATA
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_INODATA.
    WHEN 'KSCHL_001'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKSCHL_001
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKSCHL_001.
    WHEN 'SELKZ_01_002'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ISELKZ_01_002
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ISELKZ_01_002.
    WHEN 'SELKZ_04_003'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ISELKZ_04_003
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_ISELKZ_04_003.
    WHEN 'VKORG_004'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IVKORG_004
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IVKORG_004.
    WHEN 'VTWEG_005'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IVTWEG_005
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IVTWEG_005.
    WHEN 'KUNNR_006'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKUNNR_006
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKUNNR_006.
    WHEN 'MATNR_01_007'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IMATNR_01_007
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IMATNR_01_007.
    WHEN 'KBETR_01_008'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKBETR_01_008
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKBETR_01_008.
    WHEN 'KONWA_01_009'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKONWA_01_009
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKONWA_01_009.
    WHEN 'KPEIN_01_010'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKPEIN_01_010
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKPEIN_01_010.
    WHEN 'KMEIN_01_011'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKMEIN_01_011
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IKMEIN_01_011.
    WHEN 'DATAB_01_012'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IDATAB_01_012
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IDATAB_01_012.
    WHEN 'DATBI_01_013'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IDATBI_01_013
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IDATBI_01_013.
    WHEN 'QUAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IQUAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IQUAT.
    WHEN 'BLOCK'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IBLOCK
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  VALUE = %_IBLOCK.
  ENDCASE.
ENDFORM.
FORM PARAMETER_READ_OUTPUT USING NAME
                                 KEY
                        CHANGING VALUE.
  CASE NAME.
    WHEN 'CTU'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ICTU
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'MODE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IMODE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'UPDATE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IUPDATE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'GROUP'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IGROUP
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'USER'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IUSER
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KEEP'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKEEP
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'HOLDDATE'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IHOLDDATE
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'NODATA'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_INODATA
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KSCHL_001'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKSCHL_001
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'SELKZ_01_002'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ISELKZ_01_002
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'SELKZ_04_003'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_ISELKZ_04_003
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'VKORG_004'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IVKORG_004
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'VTWEG_005'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IVTWEG_005
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KUNNR_006'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKUNNR_006
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'MATNR_01_007'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IMATNR_01_007
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KBETR_01_008'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKBETR_01_008
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KONWA_01_009'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKONWA_01_009
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KPEIN_01_010'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKPEIN_01_010
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'KMEIN_01_011'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IKMEIN_01_011
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'DATAB_01_012'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IDATAB_01_012
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'DATBI_01_013'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IDATBI_01_013
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'QUAT'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IQUAT
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'BLOCK'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_IBLOCK
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
    WHEN 'SUBRC'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
      IMPORT %_VSUBRC
             FROM DATABASE EUFUNC(FL) ID KEY.
 ENDCATCH.
  ENDCASE.
ENDFORM.
FORM PARAMETER_COMPARE USING NAME
                       CHANGING VALUE.
  CASE NAME.
    WHEN 'SUBRC'.
      IF %_OSUBRC &lt;&gt; %_VSUBRC.
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
    WHEN 'MESSTAB'.
      IF %_OMESSTAB[] &lt;&gt; %_VMESSTAB[].
        VALUE = 'X'.
      ELSE.
        CLEAR VALUE.
      ENDIF.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT_MEMORY USING SEL KEY STRUCTURE EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_ICTU
%_IMODE
%_IUPDATE
%_IGROUP
%_IUSER
%_IKEEP
%_IHOLDDATE
%_INODATA
%_IKSCHL_001
%_ISELKZ_01_002
%_ISELKZ_04_003
%_IVKORG_004
%_IVTWEG_005
%_IKUNNR_006
%_IMATNR_01_007
%_IKBETR_01_008
%_IKONWA_01_009
%_IKPEIN_01_010
%_IKMEIN_01_011
%_IDATAB_01_012
%_IDATBI_01_013
%_IQUAT
%_IBLOCK
%_IMESSTAB
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VSUBRC = %_OSUBRC.
CLEAR %_VMESSTAB.
REFRESH %_VMESSTAB.
LOOP AT %_OMESSTAB.
  %_VMESSTAB = %_OMESSTAB.
  APPEND %_VMESSTAB.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_ICTU
%_IMODE
%_IUPDATE
%_IGROUP
%_IUSER
%_IKEEP
%_IHOLDDATE
%_INODATA
%_IKSCHL_001
%_ISELKZ_01_002
%_ISELKZ_04_003
%_IVKORG_004
%_IVTWEG_005
%_IKUNNR_006
%_IMATNR_01_007
%_IKBETR_01_008
%_IKONWA_01_009
%_IKPEIN_01_010
%_IKMEIN_01_011
%_IDATAB_01_012
%_IDATBI_01_013
%_IQUAT
%_IBLOCK
%_IMESSTAB
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VSUBRC = %_OSUBRC.
CLEAR %_VMESSTAB.
REFRESH %_VMESSTAB.
LOOP AT %_OMESSTAB.
  %_VMESSTAB = %_OMESSTAB.
  APPEND %_VMESSTAB.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
TO MEMORY ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM MEMORY ID KEY.
 ENDCATCH.
RC = V_RC.
%_OSUBRC = %_VSUBRC.
CLEAR %_OMESSTAB.
REFRESH %_OMESSTAB.
LOOP AT %_VMESSTAB.
  %_OMESSTAB = %_VMESSTAB.
  APPEND %_OMESSTAB.
ENDLOOP.
  ENDCASE.
ENDFORM.
FORM EXPORT_IMPORT USING SEL KEY STRUCTURE D102N_EXPORTKEY.
 CASE SEL.
WHEN 'II'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_ICTU
%_IMODE
%_IUPDATE
%_IGROUP
%_IUSER
%_IKEEP
%_IHOLDDATE
%_INODATA
%_IKSCHL_001
%_ISELKZ_01_002
%_ISELKZ_04_003
%_IVKORG_004
%_IVTWEG_005
%_IKUNNR_006
%_IMATNR_01_007
%_IKBETR_01_008
%_IKONWA_01_009
%_IKPEIN_01_010
%_IKMEIN_01_011
%_IDATAB_01_012
%_IDATBI_01_013
%_IQUAT
%_IBLOCK
%_IMESSTAB
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'IO'.
V_RC = RC.
%_VSUBRC = %_OSUBRC.
CLEAR %_VMESSTAB.
REFRESH %_VMESSTAB.
LOOP AT %_OMESSTAB.
  %_VMESSTAB = %_OMESSTAB.
  APPEND %_VMESSTAB.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_ICTU
%_IMODE
%_IUPDATE
%_IGROUP
%_IUSER
%_IKEEP
%_IHOLDDATE
%_INODATA
%_IKSCHL_001
%_ISELKZ_01_002
%_ISELKZ_04_003
%_IVKORG_004
%_IVTWEG_005
%_IKUNNR_006
%_IMATNR_01_007
%_IKBETR_01_008
%_IKONWA_01_009
%_IKPEIN_01_010
%_IKMEIN_01_011
%_IDATAB_01_012
%_IDATBI_01_013
%_IQUAT
%_IBLOCK
%_IMESSTAB
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'VI'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
WHEN 'VO'.
V_RC = RC.
%_VSUBRC = %_OSUBRC.
CLEAR %_VMESSTAB.
REFRESH %_VMESSTAB.
LOOP AT %_OMESSTAB.
  %_VMESSTAB = %_OMESSTAB.
  APPEND %_VMESSTAB.
ENDLOOP.
VEXCEPTION = OEXCEPTION.
  EXPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
TO DATABASE EUFUNC(FL) ID KEY.
WHEN 'IV'.
 CATCH SYSTEM-EXCEPTIONS CONNE_IMPORT_WRONG_COMP_TYPE = 1
                         CONNE_IMPORT_WRONG_OBJECT_TYPE = 2
                         CONNE_IMPORT_WRONG_COMP_LENG = 3
                         CONNE_IMPORT_WRONG_FIELD_LENG = 6
                         CONNE_IMPORT_WRONG_STRUCTURE  = 7
                         CONNE_IMPORT_WRONG_FIELD_TYPE = 4
                         IMPORT_WRONG_END_POS = 8
                         IMPORT_ALIGNMENT_MISMATCH = 5.
  IMPORT
%_VSUBRC
%_VMESSTAB
TIME1
V_RC
VEXCEPTION
G_UPPER
FROM DATABASE EUFUNC(FL) ID KEY ACCEPTING PADDING
                         IGNORING CONVERSION ERRORS.
 ENDCATCH.
RC = V_RC.
%_OSUBRC = %_VSUBRC.
CLEAR %_OMESSTAB.
REFRESH %_OMESSTAB.
LOOP AT %_VMESSTAB.
  %_OMESSTAB = %_VMESSTAB.
  APPEND %_OMESSTAB.
ENDLOOP.
  ENDCASE.
ENDFORM.
FORM GET_EXCEPTION_DIFFERENCE
 TABLES DIFFERENCES STRUCTURE UNTERSCHIED.
 IF VEXCEPTION NE OEXCEPTION.
   MOVE 'EXCEPTION' TO DIFFERENCES-PARAMETER.
   IF VEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-ALT.
   ELSE.
     MOVE VEXCEPTION TO DIFFERENCES-ALT.
   ENDIF.
   IF OEXCEPTION = SPACE.
     MOVE '-' TO DIFFERENCES-NEU.
   ELSE.
     MOVE OEXCEPTION TO DIFFERENCES-NEU.
   ENDIF.
   APPEND DIFFERENCES.
  ENDIF.
ENDFORM.
FORM COMPARE_DATA
                  TABLES DIFFERENCES STRUCTURE UNTERSCHIED
                  USING FIELD
                  CHANGING RETCODE.
 DATA : SUBRC LIKE SY-SUBRC.
 field-symbols: &lt;l_f1&gt; type x.
 field-symbols: &lt;l_f2&gt; type x.
 RETCODE = '='.
 CLEAR DIFFERENCES.
 CASE FIELD.
 WHEN 'SUBRC'.
IF %_OSUBRC
NE %_VSUBRC.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VSUBRC to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OSUBRC to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
ENDIF.
WHEN 'MESSTAB'.
DO.
READ TABLE %_OMESSTAB INDEX SY-INDEX.
SUBRC = SY-SUBRC.
READ TABLE %_VMESSTAB INDEX SY-INDEX.
IF SY-SUBRC NE 0 AND SUBRC NE 0.
EXIT.
ELSEIF SY-SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_OMESSTAB to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF SUBRC NE 0.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VMESSTAB to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ELSEIF %_VMESSTAB
NE %_OMESSTAB.
RETCODE = SPACE.
MOVE FIELD TO DIFFERENCES-PARAMETER.
assign %_VMESSTAB to &lt;l_f1&gt; casting.
assign differences-alt to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
assign %_OMESSTAB to &lt;l_f1&gt; casting.
assign differences-neu to &lt;l_f2&gt; casting.
&lt;l_f2&gt; = &lt;l_f1&gt;.
APPEND DIFFERENCES.
EXIT.
ENDIF.
ENDDO.
WHEN 'EXCEPTION'.
IF VEXCEPTION NE OEXCEPTION.
RETCODE = SPACE.
MOVE FIELD      TO DIFFERENCES-PARAMETER.
MOVE VEXCEPTION TO DIFFERENCES-ALT.
MOVE OEXCEPTION TO DIFFERENCES-NEU.
APPEND DIFFERENCES.
ENDIF.
  ENDCASE.
ENDFORM.
</pre>
<hr>
<font size="2" face = "Sans Serif">Extracted by Direct Download Enterprise version 1.3.1 - E.G.Mellodew. 1998-2005 UK. Sap Release 750
</font>
</body>
</html>
